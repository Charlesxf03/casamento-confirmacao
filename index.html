<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes, viewport-fit=cover">
    <title>J√∫nia & Charles ¬∑ Confirma√ß√£o at√© 10/04</title>
    <!-- Meta tags -->
    <meta name="theme-color" content="#7c2d4f">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Casamento J√∫nia & Charles">
    <!-- Fontes -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700;800&family=Quicksand:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Quicksand', sans-serif;
            background: #faf3f0;
            background-image: radial-gradient(circle at 10% 30%, rgba(247, 203, 219, 0.2) 0%, transparent 25%),
                              radial-gradient(circle at 90% 70%, rgba(230, 195, 210, 0.15) 0%, transparent 35%);
            min-height: 100vh;
            display: flex; flex-direction: column; align-items: center; padding: 0 0 2rem;
        }
        .hero {
            background: linear-gradient(165deg, #8e3b5f 0%, #b24c74 40%, #d1648d 100%);
            width: 100%; border-radius: 0 0 60px 60px; padding: 2.5rem 1.2rem 3.2rem;
            box-shadow: 0 25px 35px -12px rgba(110,30,60,0.5); position: relative; overflow: hidden; z-index: 5; margin-bottom: 2rem;
        }
        .hero::before { content: "üíç"; font-size: 16rem; color: rgba(255,255,255,0.03); position: absolute; bottom: -50px; right: -30px; transform: rotate(20deg); pointer-events: none; }
        .hero::after { content: "ü•Ç"; font-size: 12rem; color: rgba(255,255,255,0.03); position: absolute; top: -30px; left: -30px; transform: rotate(-15deg); pointer-events: none; }
        .hero-content { position: relative; z-index: 10; color: white; text-align: center; }
        .hero h1 {
            font-family: 'Playfair Display', serif; font-size: 3.2rem; font-weight: 800; letter-spacing: -1px; line-height: 1.2;
            text-shadow: 0 6px 14px rgba(0,0,0,0.25); margin-bottom: 0.5rem;
        }
        .hero h1 span {
            display: block; font-size: 2.2rem; font-weight: 400; font-family: 'Quicksand', sans-serif;
            letter-spacing: 6px; text-transform: uppercase; margin-top: 0.2rem; opacity: 0.95;
        }
        .hero-event {
            background: rgba(0,0,0,0.15); backdrop-filter: blur(6px); display: inline-block; padding: 0.7rem 2.2rem;
            border-radius: 60px; font-size: 1.6rem; font-weight: 600; border: 1px solid rgba(255,255,255,0.25);
            margin: 1.2rem 0 0.8rem; box-shadow: 0 10px 18px -6px rgba(0,0,0,0.2);
        }
        .hero-event i { margin-right: 0.6rem; color: #ffd966; }
        .hero-time {
            font-size: 1.3rem; font-weight: 400; background: rgba(255,255,255,0.1); padding: 0.5rem 1.8rem;
            border-radius: 40px; display: inline-block; backdrop-filter: blur(4px); margin-bottom: 1rem;
        }
        .deadline-badge {
            background: #ffdab9; color: #4f1c33; font-weight: 700; font-size: 1.2rem; padding: 0.6rem 1.8rem;
            border-radius: 60px; display: inline-block; margin-bottom: 1.2rem; box-shadow: 0 6px 14px rgba(0,0,0,0.2);
            border: 1px solid rgba(255,255,240,0.7); backdrop-filter: blur(4px);
        }
        .deadline-badge i { margin-right: 0.5rem; color: #b22222; }
        .contact-bubbles {
            display: flex; gap: 1.5rem; justify-content: center; flex-wrap: wrap; margin-top: 0.8rem;
        }
        .contact-bubble {
            background: rgba(255,255,255,0.9); backdrop-filter: blur(8px); border-radius: 80px;
            padding: 0.6rem 1.8rem 0.6rem 0.8rem; display: inline-flex; align-items: center; gap: 0.8rem;
            color: #4f2d3b; font-weight: 600; text-decoration: none; box-shadow: 0 15px 25px -10px rgba(70,20,40,0.4);
            transition: all 0.3s cubic-bezier(0.2,0.9,0.3,1.2); border: 1px solid rgba(255,255,255,0.6); font-size: 1rem;
        }
        .contact-bubble i {
            background: #25D366; color: white; border-radius: 50%; width: 38px; height: 38px;
            display: flex; align-items: center; justify-content: center; font-size: 1.5rem; box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .contact-bubble span { display: flex; flex-direction: column; align-items: flex-start; line-height: 1.3; }
        .contact-bubble small { font-size: 0.7rem; font-weight: 400; color: #6d4c5c; }
        .contact-bubble:hover { transform: scale(1.05) translateY(-4px); background: white; box-shadow: 0 22px 30px -10px #802d53; }
        .app-main { max-width: 1000px; width: 100%; padding: 0 1.2rem; margin-top: -1.8rem; position: relative; z-index: 20; }
        .card-modern {
            background: rgba(255,255,255,0.8); backdrop-filter: blur(15px); border-radius: 56px;
            box-shadow: 0 30px 50px -25px rgba(90,30,55,0.4), 0 0 0 1px rgba(255,245,245,0.6) inset;
            padding: 2.2rem 1.8rem; margin-bottom: 2.2rem; border: 1px solid rgba(255,230,240,0.7);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card-modern:hover { transform: translateY(-6px); box-shadow: 0 35px 55px -22px #9d4b6e; }
        .card-title {
            font-family: 'Playfair Display', serif; font-size: 2.2rem; font-weight: 700; color: #6b2e4a;
            margin-bottom: 2rem; display: flex; align-items: center; gap: 1rem; border-bottom: 2px solid #fcc9dd; padding-bottom: 0.9rem;
        }
        .card-title i { background: #ffe4f0; padding: 0.8rem; border-radius: 50%; color: #aa4c76; font-size: 1.4rem; }
        .input-group { margin-bottom: 2rem; }
        .input-group label {
            font-weight: 600; color: #6b2e4a; display: flex; align-items: center; gap: 0.5rem;
            margin-bottom: 0.7rem; font-size: 1.1rem;
        }
        .input-group input, .input-group select {
            width: 100%; padding: 1.2rem 1.5rem; font-size: 1rem; border: 2px solid #fde2ec;
            border-radius: 50px; outline: none; transition: all 0.3s; background: rgba(255,255,255,0.9);
            font-family: 'Quicksand', sans-serif;
        }
        .input-group select { appearance: none; background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23802d53'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e"); background-repeat: no-repeat; background-position: right 1.5rem center; background-size: 1.5rem; }
        .input-group input:focus, .input-group select:focus { border-color: #d4618c; box-shadow: 0 0 0 6px rgba(212,97,140,0.15); }
        .family-section {
            background: rgba(253,240,245,0.6); backdrop-filter: blur(6px); border-radius: 50px; padding: 1.8rem 1.5rem;
            margin: 2rem 0 2rem; border: 2px solid #ffd9e8;
        }
        .family-section h3 { color: #802d53; font-size: 1.5rem; font-weight: 600; display: flex; gap: 0.8rem; margin-bottom: 1.5rem; }
        #family-fields-container { display: flex; flex-direction: column; gap: 1rem; margin-bottom: 1.5rem; }
        .family-field {
            display: flex; gap: 0.7rem; align-items: center; background: white; padding: 0.5rem 0.8rem 0.5rem 1.2rem;
            border-radius: 60px; border: 1px solid #fbb1cd; box-shadow: 0 4px 8px rgba(190,70,120,0.1);
        }
        .family-field input, .family-field select {
            flex: 1; padding: 0.8rem 0.6rem; border: none; background: transparent; font-family: 'Quicksand', sans-serif;
            border-bottom: 1px dashed #fec7dd; font-size: 0.95rem;
        }
        .family-field select { border-bottom: 1px dashed #fec7dd; background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23802d53'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e"); background-repeat: no-repeat; background-position: right 0.5rem center; background-size: 1.2rem; padding-right: 2rem; }
        .family-field input:focus, .family-field select:focus { outline: none; border-bottom-color: #c95988; }
        .remove-family {
            background: none; border: none; color: #e36b93; font-size: 1.6rem; cursor: pointer;
            width: 42px; height: 42px; border-radius: 50%; display: flex; align-items: center; justify-content: center;
        }
        .remove-family:hover { background: #ffeaf1; }
        .btn-add-family {
            background: white; border: 2px dashed #c95988; color: #802d53; padding: 0.8rem 2rem; border-radius: 60px;
            font-weight: 700; font-size: 1rem; cursor: pointer; display: inline-flex; align-items: center; gap: 0.7rem; transition: 0.2s;
        }
        .btn-add-family:hover { background: #fff0f7; border-style: solid; }
        .btn-submit {
            background: linear-gradient(135deg, #a73c64, #802d53); color: white; border: none; padding: 1.3rem 2rem;
            font-size: 1.5rem; font-weight: 700; border-radius: 80px; width: 100%; cursor: pointer;
            box-shadow: 0 20px 30px -8px #802d53; display: flex; align-items: center; justify-content: center; gap: 1rem; transition: 0.25s;
        }
        .btn-submit:hover { background: linear-gradient(135deg, #802d53, #632242); box-shadow: 0 25px 35px -8px #632242; transform: scale(1.02); }
        
        /* Feedback da confirma√ß√£o */
        .feedback-card {
            background: #e8f0e8; border-left: 6px solid #2e7d32; border-radius: 40px; padding: 1.2rem 1.8rem;
            margin-bottom: 2rem; display: flex; align-items: flex-start; gap: 1rem; box-shadow: 0 10px 20px rgba(0,80,20,0.1);
            animation: slideDown 0.3s ease;
        }
        .feedback-card i { color: #2e7d32; font-size: 2rem; }
        .feedback-content { flex: 1; }
        .feedback-content h4 { color: #1b5e20; font-weight: 700; margin-bottom: 0.3rem; }
        .feedback-content p { margin: 0.2rem 0; color: #2c3e2c; }
        .feedback-content .family-feedback { margin-top: 0.5rem; padding-left: 0.5rem; }
        .feedback-close {
            background: none; border: none; color: #558b55; font-size: 1.2rem; cursor: pointer; align-self: center;
        }
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* √Årea protegida - olho dentro do campo */
        .protected-area { margin-top: 1rem; }
        .auth-box {
            background: rgba(255, 240, 245, 0.7); border-radius: 60px; padding: 1.5rem;
            text-align: center; border: 2px dashed #fbb1cd;
        }
        .auth-box p { color: #802d53; font-weight: 600; margin-bottom: 1rem; }
        .auth-input-group {
            display: flex; gap: 0.5rem; justify-content: center; flex-wrap: wrap;
            align-items: center;
        }
        .password-wrapper {
            position: relative;
            flex: 1;
            min-width: 200px;
        }
        .password-wrapper input {
            width: 100%;
            padding: 0.8rem 1.2rem;
            padding-right: 3rem;
            border: 2px solid #fde2ec;
            border-radius: 50px;
            font-family: 'Quicksand', sans-serif;
            font-size: 1rem;
        }
        .password-wrapper input:focus {
            border-color: #d4618c;
            outline: none;
        }
        .password-toggle {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            color: #b24c74;
            font-size: 1.2rem;
            padding: 0.2rem;
        }
        .password-toggle:hover { color: #8e3b5f; }
        .auth-btn {
            background: #b24c74; color: white; border: none; padding: 0.8rem 2rem;
            border-radius: 50px; font-weight: 600; cursor: pointer; transition: 0.2s;
            display: inline-flex; align-items: center; gap: 0.5rem;
        }
        .auth-btn:hover { background: #8e3b5f; }
        .logout-btn {
            background: transparent; border: 1px solid #b24c74; color: #b24c74;
            padding: 0.4rem 1.2rem; border-radius: 40px; font-size: 0.9rem; cursor: pointer;
            margin-left: 1rem; transition: 0.2s;
        }
        .logout-btn:hover { background: #b24c74; color: white; }
        
        /* Painel de estat√≠sticas */
        .stats-panel {
            background: #fcecf2; border-radius: 60px; padding: 1.5rem; margin-bottom: 2rem;
            display: flex; flex-wrap: wrap; justify-content: space-around; gap: 1rem;
            border: 1px solid #fbb5d0;
        }
        .stat-item {
            text-align: center; flex: 1 1 150px;
        }
        .stat-value {
            font-size: 2.5rem; font-weight: 800; color: #802d53; line-height: 1;
        }
        .stat-label {
            font-size: 0.9rem; color: #a55a7a; text-transform: uppercase; letter-spacing: 1px;
        }
        
        .guest-list { margin-top: 1.2rem; }
        .guest-item {
            background: white; border-radius: 60px; padding: 1.4rem 1.6rem; margin-bottom: 1.2rem;
            box-shadow: 0 12px 20px -14px #a25074; border: 1px solid #ffdae8; transition: all 0.25s;
        }
        .guest-item:hover { border-color: #e590b4; box-shadow: 0 14px 24px -12px #b24c74; }
        .guest-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.8rem; }
        .guest-main { font-size: 1.4rem; font-weight: 700; color: #6b2e4a; }
        .guest-main i { color: #b24c74; margin-right: 0.8rem; }
        .delete-guest { background: #ffeeee; border: none; color: #c23f5a; width: 44px; height: 44px; border-radius: 50%; font-size: 1.2rem; cursor: pointer; }
        .delete-guest:hover { background: #ffd9df; }
        .family-list { display: flex; flex-wrap: wrap; gap: 0.8rem; margin-left: 0.5rem; }
        .family-badge {
            background: #fcf0f5; border-radius: 60px; padding: 0.4rem 1.3rem; font-size: 0.95rem;
            border: 1px solid #fbc1d6; color: #802d53; display: inline-flex; align-items: center; gap: 0.5rem;
        }
        .empty-state { text-align: center; padding: 3.5rem 1.5rem; background: #fcf0f5; border-radius: 60px; color: #a05a7a; border: 2px dashed #fbc1d6; font-size: 1.2rem; }
        .footer-app { text-align: center; margin: 2rem auto 1rem; color: #a5577c; font-weight: 500; background: rgba(255,240,245,0.7); backdrop-filter: blur(4px); padding: 0.9rem 2.2rem; border-radius: 100px; width: fit-content; font-size: 1.15rem; border: 1px solid rgba(255,200,220,0.7); }
        .footer-app i { color: #d4618c; margin: 0 0.3rem; }
        .whatsapp-float {
            position: fixed; bottom: 25px; right: 25px; background: #25D366; width: 65px; height: 65px;
            border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white;
            font-size: 2.3rem; box-shadow: 0 15px 25px rgba(0,0,0,0.3); border: 3px solid white; transition: 0.3s; z-index: 100; text-decoration: none;
        }
        .whatsapp-float:hover { transform: scale(1.1) rotate(5deg); background: #20b859; }
        
        /* Depura√ß√£o */
        .debug-panel {
            background: #fff3cd; border: 1px solid #ffeeba; border-radius: 40px; padding: 1rem;
            margin-bottom: 1rem; color: #856404; font-size: 0.9rem;
        }
        .debug-panel button {
            background: #856404; color: white; border: none; padding: 0.3rem 1rem; border-radius: 20px; cursor: pointer;
        }
        @media (max-width: 768px) {
            .hero h1 { font-size: 2.5rem; } .hero h1 span { font-size: 1.8rem; letter-spacing: 3px; }
            .hero-event { font-size: 1.3rem; padding: 0.5rem 1.5rem; } .hero-time { font-size: 1.1rem; }
            .deadline-badge { font-size: 1rem; padding: 0.5rem 1.2rem; }
            .contact-bubble { padding: 0.5rem 1.2rem 0.5rem 0.6rem; font-size: 0.9rem; }
            .contact-bubble i { width: 32px; height: 32px; font-size: 1.2rem; }
            .card-title { font-size: 1.8rem; } .btn-submit { font-size: 1.3rem; padding: 1rem; }
        }
        @media (max-width: 480px) {
            .hero { border-radius: 0 0 40px 40px; padding: 1.8rem 0.8rem 2.5rem; }
            .hero h1 { font-size: 2rem; } .hero h1 span { font-size: 1.4rem; letter-spacing: 2px; }
            .hero-event { font-size: 1.1rem; } .hero-time { font-size: 0.95rem; }
            .deadline-badge { font-size: 0.9rem; padding: 0.4rem 1rem; }
            .contact-bubbles { gap: 0.8rem; }
            .contact-bubble { padding: 0.4rem 1rem 0.4rem 0.5rem; font-size: 0.8rem; }
            .contact-bubble i { width: 28px; height: 28px; font-size: 1rem; }
            .card-modern { padding: 1.5rem 1.2rem; border-radius: 40px; }
            .family-field { flex-wrap: wrap; border-radius: 30px; padding: 0.8rem; }
            .family-field input, .family-field select { width: 100%; }
            .btn-add-family { width: 100%; justify-content: center; }
            .whatsapp-float { width: 55px; height: 55px; font-size: 2rem; bottom: 15px; right: 15px; }
        }
    </style>
</head>
<body>
    <div class="hero">
        <div class="hero-content">
            <h1>
                J√∫nia & Charles
                <span>festa de casamento</span>
            </h1>
            <div class="hero-event">
                <i class="fas fa-calendar-alt"></i> 20 ¬∑ 06 ¬∑ 2026
            </div>
            <div class="hero-time">
                <i class="fas fa-clock"></i> A partir das 19:30
            </div>
            <div class="deadline-badge">
                <i class="fas fa-hourglass-half"></i> Confirme sua presen√ßa at√© 10 de abril de 2026
            </div>

            <div class="contact-bubbles">
                <a href="https://wa.me/5531993887733?text=Ol√°%20Charles%21%20Tudo%20bem%3F%20Estou%20entrando%20em%20contato%20sobre%20o%20casamento%20com%20a%20J√∫nia." class="contact-bubble" target="_blank">
                    <i class="fab fa-whatsapp"></i>
                    <span><strong>Charles</strong><small>(31) 99388-7733</small></span>
                </a>
                <a href="https://wa.me/5531975558328?text=Oi%20J√∫nia%21%20Que%20alegria%20poder%20participar%20desse%20momento%20especial.%20Estou%20confirmando%20minha%20presen√ßa..." class="contact-bubble" target="_blank">
                    <i class="fab fa-whatsapp"></i>
                    <span><strong>J√∫nia</strong><small>(31) 97555-8328</small></span>
                </a>
            </div>
            <p style="margin-top: 1rem; font-size: 0.95rem; opacity: 0.9; background: rgba(0,0,0,0.1); padding: 0.3rem 1.5rem; border-radius: 40px; display: inline-block;">
                <i class="fab fa-whatsapp"></i> Clique nos nomes para falar diretamente com os noivos
            </p>
        </div>
    </div>

    <div class="app-main">
        <div id="debug-area" class="debug-panel" style="display: none;">
            <strong>üîß Depura√ß√£o:</strong> <span id="debug-info"></span>
            <button id="clear-data">Limpar dados</button>
        </div>

        <div id="feedback-area" style="min-height: 20px;"></div>

        <div class="card-modern">
            <div class="card-title">
                <i class="fas fa-envelope-open-text"></i> Confirmar presen√ßa
            </div>
            <form id="guest-form">
                <div class="input-group">
                    <label for="mainName"><i class="fas fa-user-astronaut"></i> Seu nome completo *</label>
                    <input type="text" id="mainName" placeholder="Digite seu nome" required>
                </div>
                <div class="input-group">
                    <label for="phone"><i class="fas fa-phone-alt"></i> Telefone / WhatsApp *</label>
                    <input type="tel" id="phone" placeholder="(31) 99999-9999" required>
                </div>
                <div class="family-section">
                    <h3><i class="fas fa-heart-circle-plus"></i> Acompanhantes</h3>
                    <div id="family-fields-container"></div>
                    <button type="button" class="btn-add-family" id="add-family-btn">
                        <i class="fas fa-plus-circle"></i> Adicionar familiar
                    </button>
                </div>
                <button type="submit" class="btn-submit">
                    <i class="fas fa-check-double"></i> Confirmar presen√ßa
                </button>
            </form>
        </div>

        <div class="card-modern">
            <div class="card-title">
                <i class="fas fa-champagne-glasses"></i> Lista de confirma√ß√µes
                <span style="font-size: 0.9rem; background: #fcecf2; padding: 0.3rem 1rem; border-radius: 40px; margin-left: auto; display: flex; align-items: center; gap: 0.3rem;">
                    <i class="fas fa-lock" id="lockIcon"></i> <span id="authStatus">Apenas noivos</span>
                </span>
            </div>
            <div id="guest-list-container" class="protected-area"></div>
        </div>

        <div class="footer-app">
            <i class="fas fa-heart"></i> 20/06/2026 ¬∑ 19:30  <i class="fas fa-heart"></i>
        </div>
    </div>

    <a href="https://wa.me/5531975558328?text=Oi%2C%20tudo%20bem%3F%20Gostaria%20de%20falar%20sobre%20o%20casamento." class="whatsapp-float" target="_blank">
        <i class="fab fa-whatsapp"></i>
    </a>

    <script>
        // üî• CONFIGURA√á√ÉO DO FIREBASE (com a URL padr√£o do seu projeto)
        const firebaseConfig = {
            apiKey: "AIzaSyDwlHZ0cxYVHGiOUyO37lxXy9weUgHYsoc",
            authDomain: "casamento-junia-charles.firebaseapp.com",
            databaseURL: "https://casamento-junia-charles-default-rtdb.firebaseio.com", // Verifique se esta URL est√° correta no seu console Firebase
            projectId: "casamento-junia-charles",
            storageBucket: "casamento-junia-charles.firebasestorage.app",
            messagingSenderId: "517322884215",
            appId: "1:517322884215:web:efe0162432807583edb272"
        };

        // Inicializa o Firebase
        let database;
        let confirmacoesRef;
        try {
            firebase.initializeApp(firebaseConfig);
            database = firebase.database();
            confirmacoesRef = database.ref('confirmacoes');
            console.log('Firebase inicializado com sucesso!');
        } catch (error) {
            console.error('Erro ao inicializar Firebase:', error);
            alert('Erro de configura√ß√£o do Firebase. Verifique sua chave e URL do banco de dados.');
        }

        (function() {
            let guests = [];
            let authenticated = false;

            const form = document.getElementById('guest-form');
            const mainNameInput = document.getElementById('mainName');
            const phoneInput = document.getElementById('phone');
            const familyContainer = document.getElementById('family-fields-container');
            const addFamilyBtn = document.getElementById('add-family-btn');
            const guestListContainer = document.getElementById('guest-list-container');
            const lockIcon = document.getElementById('lockIcon');
            const authStatus = document.getElementById('authStatus');
            const feedbackArea = document.getElementById('feedback-area');
            const debugInfo = document.getElementById('debug-info');

            if (confirmacoesRef) {
                // Listener do Firebase
                confirmacoesRef.on('value', (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        guests = Object.values(data);
                    } else {
                        guests = [];
                    }
                    console.log('Dados carregados:', guests);
                    if (debugInfo) debugInfo.innerText = `Total: ${guests.length}`;
                    renderGuestList();
                }, (error) => {
                    console.error('Erro ao carregar dados:', error);
                    guestListContainer.innerHTML = `<div class="empty-state">Erro ao conectar com o banco. Verifique as regras do Firebase.</div>`;
                });
            } else {
                guestListContainer.innerHTML = `<div class="empty-state">Firebase n√£o inicializado. Verifique a configura√ß√£o.</div>`;
            }

            function showFeedback(guestData) {
                const { mainName, phone, family } = guestData;
                let familyHtml = '';
                if (family && family.length > 0) {
                    familyHtml = '<div class="family-feedback"><strong>Acompanhantes:</strong><ul style="margin-left: 1.2rem;">';
                    family.forEach(f => { familyHtml += `<li>${f.name} (${f.relation})</li>`; });
                    familyHtml += '</ul></div>';
                } else { familyHtml = '<p><em>Sem acompanhantes</em></p>'; }

                const feedbackDiv = document.createElement('div');
                feedbackDiv.className = 'feedback-card';
                feedbackDiv.innerHTML = `
                    <i class="fas fa-check-circle"></i>
                    <div class="feedback-content">
                        <h4><i class="fas fa-check"></i> Presen√ßa confirmada com sucesso!</h4>
                        <p><strong>Nome:</strong> ${mainName}</p>
                        <p><strong>Telefone:</strong> ${phone}</p>
                        ${familyHtml}
                        <p style="font-size:0.9rem; margin-top:0.5rem; color:#3d6e3d;">‚ú® Seus dados foram registrados. Aguardamos voc√™s!</p>
                    </div>
                    <button class="feedback-close" onclick="this.parentElement.remove()"><i class="fas fa-times"></i></button>
                `;
                feedbackArea.innerHTML = '';
                feedbackArea.appendChild(feedbackDiv);
                setTimeout(() => { if (feedbackDiv.parentNode) feedbackDiv.remove(); }, 8000);
            }

            function renderGuestList() {
                if (authenticated) {
                    lockIcon.className = 'fas fa-lock-open';
                    authStatus.innerText = 'Noivos';
                    renderGuests();
                } else {
                    lockIcon.className = 'fas fa-lock';
                    authStatus.innerText = 'Apenas noivos';
                    guestListContainer.innerHTML = `
                        <div class="auth-box">
                            <p><i class="fas fa-shield-alt"></i> √Årea restrita aos noivos</p>
                            <div class="auth-input-group">
                                <div class="password-wrapper">
                                    <input type="password" id="passwordInput" placeholder="Digite a senha" />
                                    <button class="password-toggle" id="togglePassword" type="button">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                                <button class="auth-btn" id="authBtn"><i class="fas fa-unlock-alt"></i> Acessar</button>
                            </div>
                        </div>
                    `;
                    const toggleBtn = document.getElementById('togglePassword');
                    const passwordInput = document.getElementById('passwordInput');
                    if (toggleBtn && passwordInput) {
                        toggleBtn.addEventListener('click', function() {
                            const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                            passwordInput.setAttribute('type', type);
                            this.innerHTML = type === 'password' ? '<i class="fas fa-eye"></i>' : '<i class="fas fa-eye-slash"></i>';
                        });
                    }
                    document.getElementById('authBtn')?.addEventListener('click', checkPassword);
                    passwordInput?.addEventListener('keypress', (e) => { if (e.key === 'Enter') checkPassword(); });
                }
            }

            function checkPassword() {
                const pwd = document.getElementById('passwordInput')?.value;
                if (pwd === 'noivos2026') { 
                    authenticated = true; 
                    renderGuestList(); 
                } else { 
                    alert('Senha incorreta!'); 
                }
            }

            function renderGuests() {
                if (!guests.length) {
                    guestListContainer.innerHTML = '<div class="empty-state"><i class="fa-regular fa-face-smile-wink"></i> Ningu√©m confirmou ainda. <br> Seja o primeiro!</div>';
                    return;
                }
                const totalConfirmacoes = guests.length;
                let totalAcompanhantes = 0;
                guests.forEach(g => { totalAcompanhantes += g.family ? g.family.length : 0; });
                const totalPessoas = totalConfirmacoes + totalAcompanhantes;
                const mediaAcompanhantes = totalConfirmacoes > 0 ? (totalAcompanhantes / totalConfirmacoes).toFixed(1) : 0;

                let html = `<div class="stats-panel">
                    <div class="stat-item"><div class="stat-value">${totalConfirmacoes}</div><div class="stat-label">Confirma√ß√µes</div></div>
                    <div class="stat-item"><div class="stat-value">${totalPessoas}</div><div class="stat-label">Pessoas</div></div>
                    <div class="stat-item"><div class="stat-value">${totalAcompanhantes}</div><div class="stat-label">Acompanhantes</div></div>
                    <div class="stat-item"><div class="stat-value">${mediaAcompanhantes}</div><div class="stat-label">M√©dia por grupo</div></div>
                </div>`;

                guests.forEach(guest => {
                    const family = guest.family || [];
                    const familyBadges = family.map(f => `<span class="family-badge"><i class="fas fa-user-plus"></i> ${f.name} (${f.relation})</span>`).join('');
                    html += `<div class="guest-item" data-id="${guest.id}">
                        <div class="guest-header"><span class="guest-main"><i class="fas fa-crown"></i> ${guest.mainName}</span>
                        <button class="delete-guest" onclick="removeGuest('${guest.id}')" title="Remover"><i class="fas fa-trash-alt"></i></button></div>
                        <div style="margin-left: 2.2rem; margin-bottom: 0.5rem; font-size: 0.95rem; color: #a55a7a;"><i class="fas fa-phone-alt"></i> ${guest.phone}</div>
                        <div class="family-list">${familyBadges}</div>
                    </div>`;
                });
                html += `<div style="text-align: right; margin-top: 1rem;"><button class="logout-btn" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Sair (modo noivos)</button></div>`;
                guestListContainer.innerHTML = html;
                document.getElementById('logoutBtn')?.addEventListener('click', () => { authenticated = false; renderGuestList(); });
            }

            function addFamilyField(name = '', relation = 'filho') {
                const fieldDiv = document.createElement('div'); fieldDiv.className = 'family-field';
                const nameInput = document.createElement('input'); nameInput.type = 'text'; nameInput.placeholder = 'Nome do familiar'; nameInput.value = name;
                const relationSelect = document.createElement('select');
                const options = ['filho', 'esposo', 'esposa'];
                options.forEach(opt => {
                    const option = document.createElement('option'); option.value = opt; option.textContent = opt;
                    if (opt === relation) option.selected = true;
                    relationSelect.appendChild(option);
                });
                const removeBtn = document.createElement('button'); removeBtn.type = 'button'; removeBtn.className = 'remove-family';
                removeBtn.innerHTML = '<i class="fas fa-times-circle"></i>';
                removeBtn.addEventListener('click', () => fieldDiv.remove());
                fieldDiv.appendChild(nameInput); fieldDiv.appendChild(relationSelect); fieldDiv.appendChild(removeBtn);
                familyContainer.appendChild(fieldDiv);
            }

            function resetForm() { mainNameInput.value = ''; phoneInput.value = ''; familyContainer.innerHTML = ''; }

            function collectFamilyData() {
                const fields = document.querySelectorAll('.family-field');
                const family = [];
                fields.forEach(field => {
                    const nameInput = field.querySelector('input[type="text"]');
                    const relationSelect = field.querySelector('select');
                    if (nameInput && relationSelect) {
                        const name = nameInput.value.trim();
                        const relation = relationSelect.value;
                        if (name !== '') family.push({ name, relation });
                    }
                });
                return family;
            }

            form.addEventListener('submit', function(e) {
                e.preventDefault();
                const mainName = mainNameInput.value.trim();
                const phone = phoneInput.value.trim();
                if (!mainName) { alert('Por favor, digite seu nome.'); return; }
                if (!phone) { alert('Por favor, informe seu telefone para contato.'); return; }
                const family = collectFamilyData();
                const newGuest = { 
                    id: Date.now().toString(),
                    mainName, 
                    phone, 
                    family 
                };
                if (confirmacoesRef) {
                    confirmacoesRef.push(newGuest);
                    showFeedback(newGuest);
                    resetForm();
                } else {
                    alert('Firebase n√£o dispon√≠vel. Verifique a configura√ß√£o.');
                }
            });

            addFamilyBtn.addEventListener('click', () => addFamilyField());

            window.removeGuest = function(id) {
                if (!authenticated || !confirmacoesRef) return;
                confirmacoesRef.once('value', (snapshot) => {
                    snapshot.forEach((childSnapshot) => {
                        if (childSnapshot.val().id === id) {
                            childSnapshot.ref.remove();
                        }
                    });
                });
            };

            document.getElementById('clear-data')?.addEventListener('click', () => {
                if (confirm('Limpar todas as confirma√ß√µes?')) {
                    if (confirmacoesRef) confirmacoesRef.remove();
                }
            });
        })();
    </script>
</body>
</html>
